@page "/components/color-picker-provider"
@namespace RizzyUI.Docs.Components.Pages.Components

@using System.ComponentModel.DataAnnotations
@using Rizzy.Components
@using RizzyUI

<PageTitle>Color Picker Provider</PageTitle>

<RzQuickReferenceContainer>
    <RzArticle ProseWidth="ProseWidth.UltraWide">
        <SideContent>
            <RzQuickReference />
        </SideContent>
        <MainContent>
            <RzBreadcrumb class="mb-4 not-prose">
                <BreadcrumbList>
                    <BreadcrumbItem><BreadcrumbLink Href="/">Docs</BreadcrumbLink></BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem><BreadcrumbLink Href="/components">Components</BreadcrumbLink></BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem><BreadcrumbPage>Color Picker Provider</BreadcrumbPage></BreadcrumbItem>
                </BreadcrumbList>
            </RzBreadcrumb>

            <RzHeading Level="HeadingLevel.H1" QuickReferenceTitle="Color Picker Provider" class="scroll-mt-20">Color Picker Provider</RzHeading>
            <RzParagraph>
                <code>RzColorPickerProvider</code> is an SSR-first headless provider that exposes shared Alpine state as
                <code>colorPicker.*</code> for composable trigger/input UIs. It integrates the
                <a href="https://github.com/mdbassit/Coloris" target="_blank" rel="noopener noreferrer">Coloris color picker</a>
                while letting you compose semantic triggers with <code>RzColorPickerTrigger</code> and previews with
                <code>RzColorSwatch</code>.
            </RzParagraph>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Swatch Trigger">Swatch Trigger</RzHeading>
                <RzParagraph>
                    The smallest headless setup: a swatch-only trigger that opens Coloris and updates shared
                    <code>colorPicker.value</code> state.
                </RzParagraph>
                <RzBrowser Layout="typeof(PreviewLayout)" class="mb-5">
                    <div class="mx-auto flex min-h-90 w-full max-w-md items-center justify-center p-6">
                        <RzColorPickerProvider Value="#22c55e" Alpha="true">
                            <RzColorPickerTrigger class="inline-flex rounded-md p-1">
                                <RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Large" />
                            </RzColorPickerTrigger>
                        </RzColorPickerProvider>
                    </div>
                </RzBrowser>
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;RzColorPickerProvider Value="#22c55e" Alpha="true"&gt;
    &lt;RzColorPickerTrigger class="inline-flex rounded-md p-1"&gt;
        &lt;RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Large" /&gt;
    &lt;/RzColorPickerTrigger&gt;
&lt;/RzColorPickerProvider&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Swatches Only">Swatches Only</RzHeading>
                <RzParagraph>
                    Render only preset swatches while still allowing clear and close actions.
                </RzParagraph>
                <RzBrowser Layout="typeof(PreviewLayout)" class="mb-5">
                    <div class="mx-auto flex min-h-[14rem] w-full max-w-md items-center justify-center p-6">
                        <RzColorPickerProvider Value="@_model.AccentColor"
                                               Swatches="@_swatches"
                                               SwatchesOnly="true"
                                               CloseButton="true"
                                               ClearButton="true">
                            <RzColorPickerTrigger AsChild="true">
                                <button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border bg-background px-3 text-sm hover:bg-accent hover:text-accent-foreground">
                                    <RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" />
                                    <span x-text="colorPicker.value"></span>
                                </button>
                            </RzColorPickerTrigger>
                            <input type="text"
                                   x-model="colorPicker.value"
                                   class="mt-3 flex h-9 w-60 rounded-md border border-input bg-background px-3 text-sm"
                                   aria-label="Swatches only selected color" />
                        </RzColorPickerProvider>
                    </div>
                </RzBrowser>
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;RzColorPickerProvider Value="@@_model.AccentColor"
                       Swatches="@@_swatches"
                       SwatchesOnly="true"
                       CloseButton="true"
                       ClearButton="true"&gt;
    &lt;RzColorPickerTrigger AsChild="true"&gt;
        &lt;button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border px-3 text-sm"&gt;
            &lt;RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" /&gt;
            &lt;span x-text="colorPicker.value"&gt;&lt;/span&gt;
        &lt;/button&gt;
    &lt;/RzColorPickerTrigger&gt;
    &lt;input type="text" x-model="colorPicker.value" /&gt;
&lt;/RzColorPickerProvider&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Composable Input (EditForm)">Composable Input (EditForm)</RzHeading>
                <RzParagraph>
                    Build custom input layouts with <code>RzInputGroup</code>. These two fields show swatch triggers placed
                    both before and after the text input, while still binding value through <code>x-model="colorPicker.value"</code>.
                </RzParagraph>
                <RzBrowser Layout="typeof(PreviewLayout)" class="mb-5">
                    <div class="mx-auto w-full max-w-lg p-6">
                        <EditForm Model="_model">
                            <RzFieldSet>
                                <Field>
                                    <FieldLabel For="@(() => _model.CustomStartColor)">Swatch at Start</FieldLabel>
                                    <RzColorPickerProvider Value="@_model.CustomStartColor" Format="ColorFormat.Hex" Alpha="true" Swatches="@_swatches">
                                        <RzInputGroup>
                                            <RzColorPickerTrigger>
                                                <InputGroupAddon Align="InputGroupAddonAlign.InlineStart">
                                                    <RzColorSwatch x-model="colorPicker.value" />
                                                </InputGroupAddon>
                                            </RzColorPickerTrigger>
                                            <InputGroupInput For="@(() => _model.CustomStartColor)" x-model="colorPicker.value" />
                                        </RzInputGroup>
                                    </RzColorPickerProvider>
                                </Field>

                                <Field>
                                    <FieldLabel For="@(() => _model.CustomEndColor)">Swatch at End</FieldLabel>
                                    <RzColorPickerProvider Value="@_model.CustomEndColor" Format="ColorFormat.Hex" Alpha="true" Swatches="@_swatches">
                                        <RzInputGroup>
                                            <InputGroupInput For="@(() => _model.CustomEndColor)" x-model="colorPicker.value" />
                                            <RzColorPickerTrigger>
                                                <InputGroupAddon Align="InputGroupAddonAlign.InlineEnd">
                                                    <RzColorSwatch x-model="colorPicker.value" />
                                                </InputGroupAddon>
                                            </RzColorPickerTrigger>
                                        </RzInputGroup>
                                    </RzColorPickerProvider>
                                </Field>
                            </RzFieldSet>
                        </EditForm>
                    </div>
                </RzBrowser>
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;EditForm Model="_model"&gt;
    &lt;Field&gt;
        &lt;FieldLabel For="@@(() =&gt; _model.CustomStartColor)"&gt;Swatch at Start&lt;/FieldLabel&gt;
        &lt;RzColorPickerProvider Value="@@_model.CustomStartColor" Format="ColorFormat.Hex" Alpha="true" Swatches="@@_swatches"&gt;
            &lt;RzInputGroup&gt;
                &lt;RzColorPickerTrigger&gt;
                    &lt;InputGroupAddon Align="InputGroupAddonAlign.InlineStart"&gt;
                        &lt;RzColorSwatch x-model="colorPicker.value" /&gt;
                    &lt;/InputGroupAddon&gt;
                &lt;/RzColorPickerTrigger&gt;
                &lt;InputGroupInput For="@@(() =&gt; _model.CustomStartColor)" x-model="colorPicker.value" /&gt;
            &lt;/RzInputGroup&gt;
        &lt;/RzColorPickerProvider&gt;
    &lt;/Field&gt;
&lt;/EditForm&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Theme Picker Buttons">Theme Picker Buttons</RzHeading>
                <RzParagraph>
                    Three isolated provider instances in one form. Each trigger button renders a leading swatch and current color,
                    with hidden named inputs for standard HTML post payloads.
                </RzParagraph>
                <RzBrowser Layout="typeof(PreviewLayout)" class="mb-5">
                    <div class="mx-auto flex min-h-[24rem] w-full max-w-lg items-center justify-center p-6">
                        <form class="w-full space-y-4 rounded-md border bg-card p-5 shadow-sm">
                            <div class="space-y-1">
                                <h3 class="text-base font-semibold">Theme Colors</h3>
                                <p class="text-sm text-muted-foreground">Configure your application palette.</p>
                            </div>

                            <div class="space-y-3">
                                <div class="grid gap-2">
                                    <label class="text-sm font-medium">Primary</label>
                                    <RzColorPickerProvider Value="#386fc7" Alpha="true">
                                        <RzColorPickerTrigger AsChild="true">
                                            <button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border bg-background px-3 text-sm hover:bg-accent hover:text-accent-foreground">
                                                <RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" />
                                                <span x-text="colorPicker.value"></span>
                                            </button>
                                        </RzColorPickerTrigger>
                                        <input type="hidden" name="themePrimary" x-model="colorPicker.value" />
                                    </RzColorPickerProvider>
                                </div>

                                <div class="grid gap-2">
                                    <label class="text-sm font-medium">Secondary</label>
                                    <RzColorPickerProvider Value="#10b981" Alpha="true">
                                        <RzColorPickerTrigger AsChild="true">
                                            <button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border bg-background px-3 text-sm hover:bg-accent hover:text-accent-foreground">
                                                <RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" />
                                                <span x-text="colorPicker.value"></span>
                                            </button>
                                        </RzColorPickerTrigger>
                                        <input type="hidden" name="themeSecondary" x-model="colorPicker.value" />
                                    </RzColorPickerProvider>
                                </div>

                                <div class="grid gap-2">
                                    <label class="text-sm font-medium">Accent</label>
                                    <RzColorPickerProvider Value="#f59e0b" Alpha="true">
                                        <RzColorPickerTrigger AsChild="true">
                                            <button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border bg-background px-3 text-sm hover:bg-accent hover:text-accent-foreground">
                                                <RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" />
                                                <span x-text="colorPicker.value"></span>
                                            </button>
                                        </RzColorPickerTrigger>
                                        <input type="hidden" name="themeAccent" x-model="colorPicker.value" />
                                    </RzColorPickerProvider>
                                </div>
                            </div>

                            <div class="flex justify-end">
                                <RzButton Type="ButtonType.Submit" Disabled="true">Save Theme</RzButton>
                            </div>
                        </form>
                    </div>
                </RzBrowser>
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;form class="space-y-4"&gt;
    &lt;RzColorPickerProvider Value="#386fc7" Alpha="true"&gt;
        &lt;RzColorPickerTrigger AsChild="true"&gt;
            &lt;button type="button" class="inline-flex h-9 items-center gap-2 rounded-md border px-3 text-sm"&gt;
                &lt;RzColorSwatch x-model="colorPicker.value" Size="ColorSwatchSize.Small" /&gt;
                &lt;span x-text="colorPicker.value"&gt;&lt;/span&gt;
            &lt;/button&gt;
        &lt;/RzColorPickerTrigger&gt;
        &lt;input type="hidden" name="themePrimary" x-model="colorPicker.value" /&gt;
    &lt;/RzColorPickerProvider&gt;

    &lt;RzButton Type="ButtonType.Submit" Disabled="true"&gt;Save Theme&lt;/RzButton&gt;
&lt;/form&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Component Parameters" class="scroll-mt-20">Component Parameters</RzHeading>
                <RzParagraph>The primary configuration options on <code>RzColorPickerProvider</code>.</RzParagraph>
                <div class="overflow-x-auto not-prose">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="border-b">
                                <th class="py-2 pr-4 text-left">Parameter</th>
                                <th class="py-2 pr-4 text-left">Type</th>
                                <th class="py-2 pr-4 text-left">Default</th>
                                <th class="py-2 text-left">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="py-2 pr-4"><code>ChildContent</code></td><td class="py-2 pr-4"><code>RenderFragment?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Content rendered within provider scope.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Value</code></td><td class="py-2 pr-4"><code>string?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Initial color value loaded into <code>colorPicker.value</code>.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Format</code></td><td class="py-2 pr-4"><code>ColorFormat</code></td><td class="py-2 pr-4"><code>Hex</code></td><td class="py-2">Output format used by Coloris.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Alpha</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Enables opacity selection.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Swatches</code></td><td class="py-2 pr-4"><code>IEnumerable&lt;string&gt;?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Optional preset swatch list.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>SwatchesOnly</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Restricts selection to configured swatches.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>CloseButton</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Shows the Coloris close button.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>ClearButton</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Shows the Coloris clear button.</td></tr>
                            <tr><td class="py-2 pr-4"><code>ComponentAssetKeys</code></td><td class="py-2 pr-4"><code>string[]</code></td><td class="py-2 pr-4"><code>["Coloris"]</code></td><td class="py-2">Logical asset keys resolved through <code>RizzyUIConfig.AssetUrls</code>.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Alpine.js API">Alpine.js API</RzHeading>
                <RzParagraph>
                    <code>RzColorPickerProvider</code> exposes <code>colorPicker.value</code>, <code>colorPicker.open</code>,
                    <code>colorPicker.setValue(value)</code>, <code>colorPicker.getValue()</code>, and
                    <code>colorPicker.updateConfiguration(config)</code>.
                </RzParagraph>
                <RzParagraph>
                    On color changes, the provider dispatches <code>rz:colorpicker:onchange</code> (also available as
                    <code>Constants.Events.ColorPickerOnChange</code> in C#).
                </RzParagraph>
                <div class="overflow-x-auto not-prose">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="border-b">
                                <th class="py-2 pr-4 text-left">Event Detail Field</th>
                                <th class="py-2 text-left">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="py-2 pr-4"><code>colorPicker</code></td><td class="py-2">Reference to provider Alpine state (including <code>value</code> and helper methods).</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>updateConfiguration(config)</code></td><td class="py-2">Method to patch current Coloris runtime configuration for this provider.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>el</code></td><td class="py-2">Reference to this provider's proxy text input anchor.</td></tr>
                            <tr><td class="py-2 pr-4"><code>providerEl</code></td><td class="py-2">The provider Alpine root element.</td></tr>
                        </tbody>
                    </table>
                </div>
                <RzCodeViewer Language="@CodeLanguage.JavaScript" class="mb-10">
// Close the active Coloris dialog
Coloris.close();

// Close and revert to the original value
Coloris.close(true);
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Setup">Setup</RzHeading>
                <RzParagraph>
                    <code>RzColorPickerProvider</code> loads Coloris JavaScript from configured asset URLs at runtime.
                </RzParagraph>
                <RzParagraph>
                    To override default sources (CDN/self-hosted), configure <code>AssetUrls</code> during service registration:
                </RzParagraph>
                <RzCodeViewer Language="@CodeLanguage.CSharp" class="mb-10">
builder.Services.AddRizzyUI(config =>
{
    config.AssetUrls["Coloris"] = "https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.js";
});
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Localization">Localization</RzHeading>
                <RzParagraph>
                    <code>RzColorPickerProvider</code> uses Coloris accessibility strings from <code>RizzyLocalization.en.resx</code>.
                </RzParagraph>
                <div class="overflow-x-auto not-prose">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="border-b">
                                <th class="py-2 pr-4 text-left">Localization Key</th>
                                <th class="py-2 text-left">Default Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Open</code></td><td class="py-2">Open color picker</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Close</code></td><td class="py-2">Close color picker</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Clear</code></td><td class="py-2">Clear selected color</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Marker</code></td><td class="py-2">Saturation: {s}. Brightness: {v}.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.HueSlider</code></td><td class="py-2">Hue slider</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.AlphaSlider</code></td><td class="py-2">Opacity slider</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Format</code></td><td class="py-2">Color format</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Swatch</code></td><td class="py-2">Color swatch {i}: {swatch}</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Input</code></td><td class="py-2">Color value field</td></tr>
                            <tr><td class="py-2 pr-4"><code>RzColorPicker.A11y.Instruction</code></td><td class="py-2">Saturation and brightness selector. Use arrow keys to select.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </MainContent>
    </RzArticle>
</RzQuickReferenceContainer>

@code {
    private readonly string[] _swatches = ["#ef4444", "#f97316", "#f59e0b", "#22c55e", "#3b82f6", "#a855f7"];

    private readonly ColorPickerProviderExamplesModel _model = new();

    private sealed class ColorPickerProviderExamplesModel
    {
        [Required] public string AccentColor { get; set; } = "#f97316";
        [Required] public string CustomStartColor { get; set; } = "#3b82f6";
        [Required] public string CustomEndColor { get; set; } = "#10b981";
    }
}
