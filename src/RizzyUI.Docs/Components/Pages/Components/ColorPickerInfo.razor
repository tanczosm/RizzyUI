@page "/components/color-picker"
@namespace RizzyUI.Docs.Components.Pages.Components

@using System.ComponentModel.DataAnnotations
@using Rizzy.Components
@using RizzyUI

<PageTitle>Color Picker</PageTitle>

<RzQuickReferenceContainer>
    <RzArticle ProseWidth="ProseWidth.UltraWide">
        <SideContent>
            <RzQuickReference />
        </SideContent>
        <MainContent>
            <RzBreadcrumb class="mb-4 not-prose">
                <BreadcrumbList>
                    <BreadcrumbItem><BreadcrumbLink Href="/">Docs</BreadcrumbLink></BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem><BreadcrumbLink Href="/components">Components</BreadcrumbLink></BreadcrumbItem>
                    <BreadcrumbSeparator />
                    <BreadcrumbItem><BreadcrumbPage>Color Picker</BreadcrumbPage></BreadcrumbItem>
                </BreadcrumbList>
            </RzBreadcrumb>

            <RzHeading Level="HeadingLevel.H1" QuickReferenceTitle="Color Picker" class="scroll-mt-20">Color Picker</RzHeading>
            <RzParagraph>
                <code>RzColorPicker</code> is an SSR-first RizzyUI form component that integrates the
                <a href="https://github.com/mdbassit/Coloris" target="_blank" rel="noopener noreferrer">Coloris color picker</a>
                through Alpine.js. It renders a standard input for HTML form posts while progressively enhancing the experience with
                client-side color selection, swatches, accessibility labels, and runtime configuration updates.
            </RzParagraph>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Full Featured" class="scroll-mt-20">Full Featured (Hex + Swatches)</RzHeading>
                <RzParagraph>
                    A complete starter setup that keeps Hex format, enables alpha, shows reusable swatches, and includes close/clear controls.
                    You can open the picker by clicking either the input or the color thumbnail.
                </RzParagraph>
                <div class="mx-auto mb-5 w-full max-w-md p-8">
                    <EditForm Model="_model">
                        <Field>
                            <FieldLabel For="@(() => _model.BrandColor)">Brand Color</FieldLabel>
                            <RzColorPicker For="@(() => _model.BrandColor)"
                                           Value="@_model.BrandColor"
                                           Format="ColorFormat.Hex"
                                           Alpha
                                           Swatches="@_swatches"
                                           CloseButton
                                           ClearButton />
                        </Field>
                    </EditForm>
                </div>
                <RzEventViewer EventName="rz:colorpicker:on-change" class="mb-4" />
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;EditForm Model="_model"&gt;
    &lt;Field&gt;
        &lt;FieldLabel For="@@(() =&gt; _model.BrandColor)"&gt;Brand Color&lt;/FieldLabel&gt;
        &lt;RzColorPicker For="@@(() =&gt; _model.BrandColor)"
                       Value="@@_model.BrandColor"
                       Format="ColorFormat.Hex"
                       Alpha
                       Swatches="@@_swatches"
                       CloseButton
                       ClearButton /&gt;
    &lt;/Field&gt;
&lt;/EditForm&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="With Alpha">With Alpha + RGB</RzHeading>
                <RzParagraph>Enable alpha support and output values in RGB format.</RzParagraph>
                
                <div class="mx-auto mb-5 w-full max-w-md p-8">
                    <EditForm Model="_model">
                        <Field>
                            <FieldLabel For="@(() => _model.OverlayColor)">Overlay Color</FieldLabel>
                            <RzColorPicker For="@(() => _model.OverlayColor)" Value="@_model.OverlayColor" Alpha="true" Format="ColorFormat.Rgb" />
                        </Field>
                    </EditForm>
                </div>
                
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;RzColorPicker For="@@(() =&gt; _model.OverlayColor)"
               Value="@@_model.OverlayColor"
               Alpha="true"
               Format="ColorFormat.Rgb" /&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Swatches Only">Swatches Only</RzHeading>
                <RzParagraph>Render only preset swatches while still allowing clear and close actions.</RzParagraph>
                
                <div class="mx-auto mb-5 w-full max-w-md p-8">
                    <EditForm Model="_model">
                        <Field>
                            <FieldLabel For="@(() => _model.AccentColor)">Accent Color</FieldLabel>
                            <RzColorPicker For="@(() => _model.AccentColor)" Value="@_model.AccentColor" Swatches="@_swatches" SwatchesOnly="true" CloseButton="true" ClearButton="true" />
                        </Field>
                    </EditForm>
                </div>
            
                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;RzColorPicker For="@@(() =&gt; _model.AccentColor)"
               Value="@@_model.AccentColor"
               Swatches="@@_swatches"
               SwatchesOnly="true"
               CloseButton="true"
               ClearButton="true" /&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Thumbnail Position">Thumbnail Position</RzHeading>
                <RzParagraph>
                    Choose whether the thumbnail appears at the start or end of the input group.
                    The thumbnail is also a picker trigger, matching common color-input UX conventions.
                </RzParagraph>
                
                <div class="mx-auto mb-5 grid w-full max-w-lg gap-4 p-8">
                    <EditForm Model="_model">
                        <RzFieldSet>
                            <Field>
                                <FieldLabel For="@(() => _model.StartThumbColor)">Thumbnail Start</FieldLabel>
                                <RzColorPicker For="@(() => _model.StartThumbColor)" Value="@_model.StartThumbColor" ThumbnailPosition="ColorThumbnailPosition.Start" />
                            </Field>
                            <Field>
                                <FieldLabel For="@(() => _model.EndThumbColor)">Thumbnail End</FieldLabel>
                                <RzColorPicker For="@(() => _model.EndThumbColor)" Value="@_model.EndThumbColor" ThumbnailPosition="ColorThumbnailPosition.End" />
                            </Field>
                        </RzFieldSet>
                    </EditForm>
                </div>

                <RzCodeViewer Language="@CodeLanguage.Razor" class="mb-10">
&lt;RzColorPicker For="@@(() =&gt; _model.StartThumbColor)"
               Value="@@_model.StartThumbColor"
               ThumbnailPosition="ColorThumbnailPosition.Start" /&gt;

&lt;RzColorPicker For="@@(() =&gt; _model.EndThumbColor)"
               Value="@@_model.EndThumbColor"
               ThumbnailPosition="ColorThumbnailPosition.End" /&gt;
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Component Parameters" class="scroll-mt-20">Component Parameters</RzHeading>
                <RzParagraph>The primary configuration options on <code>RzColorPicker</code>.</RzParagraph>
                <div class="overflow-x-auto not-prose">
                    <table class="w-full text-sm border-collapse">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left py-2 pr-4">Parameter</th>
                                <th class="text-left py-2 pr-4">Type</th>
                                <th class="text-left py-2 pr-4">Default</th>
                                <th class="text-left py-2">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Value</code></td><td class="py-2 pr-4"><code>string?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Current color value rendered into the input.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>For</code></td><td class="py-2 pr-4"><code>Expression&lt;Func&lt;string&gt;&gt;?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Connects the picker to form metadata and validation.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Format</code></td><td class="py-2 pr-4"><code>ColorFormat</code></td><td class="py-2 pr-4"><code>Hex</code></td><td class="py-2">Output format sent to Coloris (<code>Hex</code>, <code>Rgb</code>, or <code>Hsl</code>).</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Alpha</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Enables opacity selection.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Swatches</code></td><td class="py-2 pr-4"><code>IEnumerable&lt;string&gt;?</code></td><td class="py-2 pr-4"><code>null</code></td><td class="py-2">Optional swatch list shown in the Coloris dialog.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>SwatchesOnly</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Limits selection to swatches only.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>CloseButton</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Shows the dialog close button.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>ClearButton</code></td><td class="py-2 pr-4"><code>bool</code></td><td class="py-2 pr-4"><code>false</code></td><td class="py-2">Shows the dialog clear button.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>Placeholder</code></td><td class="py-2 pr-4"><code>string?</code></td><td class="py-2 pr-4"><code>"Select a color"</code></td><td class="py-2">Input placeholder text (localized by default).</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>ThumbnailPosition</code></td><td class="py-2 pr-4"><code>ColorThumbnailPosition</code></td><td class="py-2 pr-4"><code>Start</code></td><td class="py-2">Places the thumbnail at the start or end of the input group.</td></tr>
                            <tr><td class="py-2 pr-4"><code>ComponentAssetKeys</code></td><td class="py-2 pr-4"><code>string[]</code></td><td class="py-2 pr-4"><code>["Coloris", "ColorisCss"]</code></td><td class="py-2">Logical asset keys resolved through <code>RizzyUIConfig.AssetUrls</code>.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Alpine.js API">Alpine.js API</RzHeading>
                <RzParagraph>
                    <code>RzColorPicker</code> uses the Alpine component <code>rzColorPicker</code> with key-based expressions only (CSP-safe).
                    The root exposes methods such as <code>handleInput</code>, <code>openPicker</code>, and <code>updateConfiguration(config)</code>.
                </RzParagraph>
                <RzParagraph>
                    When the color changes, RzColorPicker dispatches a custom DOM event named
                    <code>rz:colorpicker:on-change</code> (also available as <code>Constants.Events.ColorPickerOnChange</code> in C#).
                </RzParagraph>
                <RzParagraph>
                    <div class="overflow-x-auto not-prose">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                            <tr class="border-b">
                                <th class="text-left py-2 pr-4">Event Detail Field</th>
                                <th class="text-left py-2">Description</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="border-b">
                                <td class="py-2 pr-4"><code>rzColorPicker</code></td>
                                <td class="py-2">Reference to the Alpine <code>rzColorPicker</code> component instance.</td>
                            </tr>
                            <tr class="border-b">
                                <td class="py-2 pr-4"><code>updateConfiguration(config)</code></td>
                                <td class="py-2">Method reference you can call to update the active Coloris instance and the local component config.</td>
                            </tr>
                            <tr>
                                <td class="py-2 pr-4"><code>el</code></td>
                                <td class="py-2">Reference to the underlying input element (<code>this.$refs.input</code>).</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </RzParagraph>
                <RzParagraph>
                    To close the currently active Coloris dialog from your own scripts, use the global API:
                    
                    <RzCodeViewer Language="@CodeLanguage.JavaScript" class="mb-10">
                        // Close the dialog
                        Coloris.close();

                        // Close the dialog and revert the color to its original value
                        Coloris.close(true);
                    </RzCodeViewer>
                    
                </RzParagraph>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Setup">Setup</RzHeading>
                <RzParagraph>
                    When <code>RzColorPicker</code> is rendered, it dynamically loads the third-party Coloris JavaScript from
                    <code>jsdelivr.net</code> using the configured asset URLs.
                </RzParagraph>
                <RzParagraph>
                    To override the defaults (for a newer CDN path or local/self-hosted delivery), customize <code>AssetUrls</code> in
                    <code>Program.cs</code> when registering RizzyUI services:
                </RzParagraph>
                <RzCodeViewer Language="@CodeLanguage.CSharp" class="mb-10">
builder.Services.AddRizzyUI(config =>
{

    config.AssetUrls["Coloris"] = "https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.js";
});
                </RzCodeViewer>
            </section>

            <section class="my-8 py-2">
                <RzHeading Level="HeadingLevel.H2" QuickReferenceTitle="Localization">Localization</RzHeading>
                <RzParagraph>
                    <code>RzColorPicker</code> uses the following localization keys from <code>RizzyLocalization.en.resx</code>.
                </RzParagraph>
                <div class="overflow-x-auto not-prose">
                    <table class="w-full text-sm border-collapse">
                        <thead>
                            <tr class="border-b">
                                <th class="text-left py-2 pr-4">Localization Key</th>
                                <th class="text-left py-2">Default Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.DefaultPlaceholder</code></td><td class="py-2">Select a color</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Open</code></td><td class="py-2">Open color picker</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Close</code></td><td class="py-2">Close color picker</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Clear</code></td><td class="py-2">Clear selected color</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Marker</code></td><td class="py-2">Saturation: {s}. Brightness: {v}.</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.HueSlider</code></td><td class="py-2">Hue slider</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.AlphaSlider</code></td><td class="py-2">Opacity slider</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Format</code></td><td class="py-2">Color format</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Swatch</code></td><td class="py-2">Color swatch {i}: {swatch}</td></tr>
                            <tr class="border-b"><td class="py-2 pr-4"><code>RzColorPicker.A11y.Input</code></td><td class="py-2">Color value field</td></tr>
                            <tr><td class="py-2 pr-4"><code>RzColorPicker.A11y.Instruction</code></td><td class="py-2">Saturation and brightness selector. Use arrow keys to select.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </MainContent>
    </RzArticle>
</RzQuickReferenceContainer>

@code {
    private readonly string[] _swatches = ["#ef4444", "#f97316", "#f59e0b", "#22c55e", "#3b82f6", "#a855f7"];

    private readonly ColorPickerExamplesModel _model = new();

    private sealed class ColorPickerExamplesModel
    {
        [Required] public string BrandColor { get; set; } = "#3b82f6";
        [Required] public string OverlayColor { get; set; } = "rgba(59, 130, 246, 0.45)";
        [Required] public string AccentColor { get; set; } = "#f97316";
        [Required] public string StartThumbColor { get; set; } = "#111827";
        [Required] public string EndThumbColor { get; set; } = "#f43f5e";
    }
}
